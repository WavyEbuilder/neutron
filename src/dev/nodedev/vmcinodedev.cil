;; SPDX-FileCopyrightText: Â© 2025 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block vmci

  (filecon "/dev/vmci" char nodedev_context)
  (filecon "/dev/vsock" char nodedev_context)

  (macro dev_file_type_transition_nodedev ((type ARG1))
         (call .dev.file_type_transition
               (ARG1 nodedev chr_file "vmci"))
         (call .dev.file_type_transition
               (ARG1 nodedev chr_file "vsock")))

  (blockinherit .nodedev.template))

(in nodedev.unconfined

    (call .vmci.dev_file_type_transition_nodedev (typeattr)))
